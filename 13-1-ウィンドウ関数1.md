事前準備としてChatGPTに適当に生成してもらったテーブルとデータ(`13-0-generate.sql`)を作成する。集計や分析作業を行う際に、`GROUP BY`を用いるとテーブルをグループ化して1行にまとめるため、集計に使った元のレコードの詳細データが失われてしまう。行をまとめずに集計を行い、各行にその結果を付与したい場合はウィンドウ関数を使用することができる。ただし、クエリが複雑になりやすく、パフォーマンス面でも注意が必要なため、`GROUP BY`で十分な場合はそちらを利用する。ウィンドウ関数を使用する場合、`<ウィンドウ関数> OVER(<集計方法>)`のようにクエリを作成する。ウィンドウ関数には`GROUP BY`でも使用できた`AVG`や`SUM`のような集計関数や、ウィンドウ関数専用の`LAG`、`LEAD`などがある。使用できる関数を詳しく知りたい場合は[12.21.2 Window 関数の概念と構文](https://dev.mysql.com/doc/refman/8.0/ja/window-functions-usage.html)を参照する。以下のクエリのように`OVER()`とするとテーブル全体の集計ができる。`GROPU BY`と異なり、各レコードに追加する形で売り上げ平均が付与されていることがわかる。
```
mysql> select *, sum(total_price) over() as "売り上げ合計"
    -> from sales
    -> limit 10;
+----+------------+--------------+---------------+------------+-------------+--------------------+
| id | sale_date  | product_name | quantity_sold | unit_price | total_price | 売り上げ合計       |
+----+------------+--------------+---------------+------------+-------------+--------------------+
|  1 | 2024-02-01 | Product A    |            10 |    1000.00 |    10000.00 |         1048200.00 |
|  2 | 2024-02-01 | Product B    |             5 |    1500.00 |     7500.00 |         1048200.00 |
|  3 | 2024-02-01 | Product C    |             8 |     800.00 |     6400.00 |         1048200.00 |
|  4 | 2024-02-02 | Product A    |            12 |    1000.00 |    12000.00 |         1048200.00 |
|  5 | 2024-02-02 | Product B    |             6 |    1500.00 |     9000.00 |         1048200.00 |
|  6 | 2024-02-02 | Product C    |             7 |     800.00 |     5600.00 |         1048200.00 |
|  7 | 2024-02-03 | Product A    |             9 |    1000.00 |     9000.00 |         1048200.00 |
|  8 | 2024-02-03 | Product B    |             8 |    1500.00 |    12000.00 |         1048200.00 |
|  9 | 2024-02-03 | Product C    |            10 |     800.00 |     8000.00 |         1048200.00 |
| 10 | 2024-02-04 | Product A    |            11 |    1000.00 |    11000.00 |         1048200.00 |
+----+------------+--------------+---------------+------------+-------------+--------------------+
```

集計対象のカラムを指定する場合は`PARTITION BY`を用いる。それぞれのレコードに付与する形のため、以下のクエリのように異なるカラムでグループ(パーティションと呼ぶ)を作ることもできる。
```
mysql> select *,
    ->     sum(total_price) over(partition by sale_date) as "日ごとの売り上げ合計",
    ->     sum(total_price) over(partition by product_name) as "商品ごとの売り上げ合計"
    -> from sales;
+-----+------------+--------------+---------------+------------+-------------+--------------------------------+-----------------------------------+
| id  | sale_date  | product_name | quantity_sold | unit_price | total_price | 日ごとの売り上げ合計           | 商品ごとの売り上げ合計            |
+-----+------------+--------------+---------------+------------+-------------+--------------------------------+-----------------------------------+
|  70 | 2024-02-17 | Product A    |            13 |    1000.00 |    13000.00 |                       31500.00 |                         384000.00 |
|  85 | 2024-02-22 | Product A    |            15 |    1000.00 |    15000.00 |                       39600.00 |                         384000.00 |
|  13 | 2024-02-05 | Product A    |            15 |    1000.00 |    15000.00 |                       76200.00 |                         384000.00 |
|  82 | 2024-02-21 | Product A    |            11 |    1000.00 |    11000.00 |                       30200.00 |                         384000.00 |
|  34 | 2024-02-05 | Product A    |            15 |    1000.00 |    15000.00 |                       76200.00 |                         384000.00 |
|  79 | 2024-02-20 | Product A    |            10 |    1000.00 |    10000.00 |                       28300.00 |                         384000.00 |
|  16 | 2024-02-06 | Product A    |             8 |    1000.00 |     8000.00 |                       54000.00 |                         384000.00 |
|  76 | 2024-02-19 | Product A    |            12 |    1000.00 |    12000.00 |                       27400.00 |                         384000.00 |
|  37 | 2024-02-06 | Product A    |             8 |    1000.00 |     8000.00 |                       54000.00 |                         384000.00 |
|  73 | 2024-02-18 | Product A    |             9 |    1000.00 |     9000.00 |                       31100.00 |                         384000.00 |
|  19 | 2024-02-07 | Product A    |            13 |    1000.00 |    13000.00 |                       74800.00 |                         384000.00 |
|   1 | 2024-02-01 | Product A    |            10 |    1000.00 |    10000.00 |                       47800.00 |                         384000.00 |
|  40 | 2024-02-07 | Product A    |            13 |    1000.00 |    13000.00 |                       74800.00 |                         384000.00 |
|  67 | 2024-02-16 | Product A    |            10 |    1000.00 |    10000.00 |                       26800.00 |                         384000.00 |
|  43 | 2024-02-08 | Product A    |            14 |    1000.00 |    14000.00 |                       30200.00 |                         384000.00 |
|  64 | 2024-02-15 | Product A    |            11 |    1000.00 |    11000.00 |                       36200.00 |                         384000.00 |
|  46 | 2024-02-09 | Product A    |             7 |    1000.00 |     7000.00 |                       27000.00 |                         384000.00 |
|  61 | 2024-02-14 | Product A    |            14 |    1000.00 |    14000.00 |                       27000.00 |                         384000.00 |
|  49 | 2024-02-10 | Product A    |            10 |    1000.00 |    10000.00 |                       32100.00 |                         384000.00 |
|  58 | 2024-02-13 | Product A    |             8 |    1000.00 |     8000.00 |                       26500.00 |                         384000.00 |
|  52 | 2024-02-11 | Product A    |            12 |    1000.00 |    12000.00 |                       30300.00 |                         384000.00 |
|  55 | 2024-02-12 | Product A    |             9 |    1000.00 |     9000.00 |                       34900.00 |                         384000.00 |
| 100 | 2024-02-27 | Product A    |            10 |    1000.00 |    10000.00 |                       34400.00 |                         384000.00 |
|  25 | 2024-02-02 | Product A    |            12 |    1000.00 |    12000.00 |                       53200.00 |                         384000.00 |
|  88 | 2024-02-23 | Product A    |             8 |    1000.00 |     8000.00 |                       22500.00 |                         384000.00 |
|  97 | 2024-02-26 | Product A    |             9 |    1000.00 |     9000.00 |                       25800.00 |                         384000.00 |
|  10 | 2024-02-04 | Product A    |            11 |    1000.00 |    11000.00 |                       52600.00 |                         384000.00 |
|  22 | 2024-02-01 | Product A    |            10 |    1000.00 |    10000.00 |                       47800.00 |                         384000.00 |
| 103 | 2024-02-28 | Product A    |            11 |    1000.00 |    11000.00 |                       28700.00 |                         384000.00 |
|  91 | 2024-02-24 | Product A    |            13 |    1000.00 |    13000.00 |                       34500.00 |                         384000.00 |
|  28 | 2024-02-03 | Product A    |             9 |    1000.00 |     9000.00 |                       58000.00 |                         384000.00 |
|  31 | 2024-02-04 | Product A    |            11 |    1000.00 |    11000.00 |                       52600.00 |                         384000.00 |
|  94 | 2024-02-25 | Product A    |            12 |    1000.00 |    12000.00 |                       26600.00 |                         384000.00 |
|   4 | 2024-02-02 | Product A    |            12 |    1000.00 |    12000.00 |                       53200.00 |                         384000.00 |
|   7 | 2024-02-03 | Product A    |             9 |    1000.00 |     9000.00 |                       58000.00 |                         384000.00 |
|  59 | 2024-02-13 | Product B    |             7 |    1500.00 |    10500.00 |                       26500.00 |                         441000.00 |
|  62 | 2024-02-14 | Product B    |             6 |    1500.00 |     9000.00 |                       27000.00 |                         441000.00 |
| 101 | 2024-02-27 | Product B    |            12 |    1500.00 |    18000.00 |                       34400.00 |                         441000.00 |
|  95 | 2024-02-25 | Product B    |             6 |    1500.00 |     9000.00 |                       26600.00 |                         441000.00 |
|  56 | 2024-02-12 | Product B    |            13 |    1500.00 |    19500.00 |                       34900.00 |                         441000.00 |
| 104 | 2024-02-28 | Product B    |             7 |    1500.00 |    10500.00 |                       28700.00 |                         441000.00 |
|   2 | 2024-02-01 | Product B    |             5 |    1500.00 |     7500.00 |                       47800.00 |                         441000.00 |
|  98 | 2024-02-26 | Product B    |             8 |    1500.00 |    12000.00 |                       25800.00 |                         441000.00 |
|  65 | 2024-02-15 | Product B    |            12 |    1500.00 |    18000.00 |                       36200.00 |                         441000.00 |
|  68 | 2024-02-16 | Product B    |             8 |    1500.00 |    12000.00 |                       26800.00 |                         441000.00 |
|  71 | 2024-02-17 | Product B    |             7 |    1500.00 |    10500.00 |                       31500.00 |                         441000.00 |
|  92 | 2024-02-24 | Product B    |             9 |    1500.00 |    13500.00 |                       34500.00 |                         441000.00 |
|  74 | 2024-02-18 | Product B    |            11 |    1500.00 |    16500.00 |                       31100.00 |                         441000.00 |
|  77 | 2024-02-19 | Product B    |             6 |    1500.00 |     9000.00 |                       27400.00 |                         441000.00 |
|  89 | 2024-02-23 | Product B    |             7 |    1500.00 |    10500.00 |                       22500.00 |                         441000.00 |
|  80 | 2024-02-20 | Product B    |             9 |    1500.00 |    13500.00 |                       28300.00 |                         441000.00 |
|  86 | 2024-02-22 | Product B    |            10 |    1500.00 |    15000.00 |                       39600.00 |                         441000.00 |
|  83 | 2024-02-21 | Product B    |             8 |    1500.00 |    12000.00 |                       30200.00 |                         441000.00 |
|  20 | 2024-02-07 | Product B    |            12 |    1500.00 |    18000.00 |                       74800.00 |                         441000.00 |
|  32 | 2024-02-04 | Product B    |             7 |    1500.00 |    10500.00 |                       52600.00 |                         441000.00 |
|  14 | 2024-02-05 | Product B    |             9 |    1500.00 |    13500.00 |                       76200.00 |                         441000.00 |
|  11 | 2024-02-04 | Product B    |             7 |    1500.00 |    10500.00 |                       52600.00 |                         441000.00 |
|  35 | 2024-02-05 | Product B    |             9 |    1500.00 |    13500.00 |                       76200.00 |                         441000.00 |
|  29 | 2024-02-03 | Product B    |             8 |    1500.00 |    12000.00 |                       58000.00 |                         441000.00 |
|  17 | 2024-02-06 | Product B    |            10 |    1500.00 |    15000.00 |                       54000.00 |                         441000.00 |
|  38 | 2024-02-06 | Product B    |            10 |    1500.00 |    15000.00 |                       54000.00 |                         441000.00 |
|   8 | 2024-02-03 | Product B    |             8 |    1500.00 |    12000.00 |                       58000.00 |                         441000.00 |
|  26 | 2024-02-02 | Product B    |             6 |    1500.00 |     9000.00 |                       53200.00 |                         441000.00 |
|  41 | 2024-02-07 | Product B    |            12 |    1500.00 |    18000.00 |                       74800.00 |                         441000.00 |
|  53 | 2024-02-11 | Product B    |             9 |    1500.00 |    13500.00 |                       30300.00 |                         441000.00 |
|  44 | 2024-02-08 | Product B    |             6 |    1500.00 |     9000.00 |                       30200.00 |                         441000.00 |
|   5 | 2024-02-02 | Product B    |             6 |    1500.00 |     9000.00 |                       53200.00 |                         441000.00 |
|  47 | 2024-02-09 | Product B    |             8 |    1500.00 |    12000.00 |                       27000.00 |                         441000.00 |
|  50 | 2024-02-10 | Product B    |            11 |    1500.00 |    16500.00 |                       32100.00 |                         441000.00 |
|  23 | 2024-02-01 | Product B    |             5 |    1500.00 |     7500.00 |                       47800.00 |                         441000.00 |
|   9 | 2024-02-03 | Product C    |            10 |     800.00 |     8000.00 |                       58000.00 |                         223200.00 |
|  12 | 2024-02-04 | Product C    |             6 |     800.00 |     4800.00 |                       52600.00 |                         223200.00 |
|  87 | 2024-02-22 | Product C    |            12 |     800.00 |     9600.00 |                       39600.00 |                         223200.00 |
|  54 | 2024-02-11 | Product C    |             6 |     800.00 |     4800.00 |                       30300.00 |                         223200.00 |
|   3 | 2024-02-01 | Product C    |             8 |     800.00 |     6400.00 |                       47800.00 |                         223200.00 |
|  30 | 2024-02-03 | Product C    |            10 |     800.00 |     8000.00 |                       58000.00 |                         223200.00 |
|  90 | 2024-02-23 | Product C    |             5 |     800.00 |     4000.00 |                       22500.00 |                         223200.00 |
| 102 | 2024-02-27 | Product C    |             8 |     800.00 |     6400.00 |                       34400.00 |                         223200.00 |
|  99 | 2024-02-26 | Product C    |             6 |     800.00 |     4800.00 |                       25800.00 |                         223200.00 |
|  93 | 2024-02-24 | Product C    |            10 |     800.00 |     8000.00 |                       34500.00 |                         223200.00 |
|  24 | 2024-02-01 | Product C    |             8 |     800.00 |     6400.00 |                       47800.00 |                         223200.00 |
|  27 | 2024-02-02 | Product C    |             7 |     800.00 |     5600.00 |                       53200.00 |                         223200.00 |
| 105 | 2024-02-28 | Product C    |             9 |     800.00 |     7200.00 |                       28700.00 |                         223200.00 |
|  96 | 2024-02-25 | Product C    |             7 |     800.00 |     5600.00 |                       26600.00 |                         223200.00 |
|   6 | 2024-02-02 | Product C    |             7 |     800.00 |     5600.00 |                       53200.00 |                         223200.00 |
|  69 | 2024-02-16 | Product C    |             6 |     800.00 |     4800.00 |                       26800.00 |                         223200.00 |
|  51 | 2024-02-10 | Product C    |             7 |     800.00 |     5600.00 |                       32100.00 |                         223200.00 |
|  57 | 2024-02-12 | Product C    |             8 |     800.00 |     6400.00 |                       34900.00 |                         223200.00 |
|  48 | 2024-02-09 | Product C    |            10 |     800.00 |     8000.00 |                       27000.00 |                         223200.00 |
|  60 | 2024-02-13 | Product C    |            10 |     800.00 |     8000.00 |                       26500.00 |                         223200.00 |
|  45 | 2024-02-08 | Product C    |             9 |     800.00 |     7200.00 |                       30200.00 |                         223200.00 |
|  63 | 2024-02-14 | Product C    |             5 |     800.00 |     4000.00 |                       27000.00 |                         223200.00 |
|  42 | 2024-02-07 | Product C    |             8 |     800.00 |     6400.00 |                       74800.00 |                         223200.00 |
|  66 | 2024-02-15 | Product C    |             9 |     800.00 |     7200.00 |                       36200.00 |                         223200.00 |
|  21 | 2024-02-07 | Product C    |             8 |     800.00 |     6400.00 |                       74800.00 |                         223200.00 |
|  84 | 2024-02-21 | Product C    |             9 |     800.00 |     7200.00 |                       30200.00 |                         223200.00 |
|  39 | 2024-02-06 | Product C    |             5 |     800.00 |     4000.00 |                       54000.00 |                         223200.00 |
|  72 | 2024-02-17 | Product C    |            10 |     800.00 |     8000.00 |                       31500.00 |                         223200.00 |
|  18 | 2024-02-06 | Product C    |             5 |     800.00 |     4000.00 |                       54000.00 |                         223200.00 |
|  75 | 2024-02-18 | Product C    |             7 |     800.00 |     5600.00 |                       31100.00 |                         223200.00 |
|  36 | 2024-02-05 | Product C    |            12 |     800.00 |     9600.00 |                       76200.00 |                         223200.00 |
|  78 | 2024-02-19 | Product C    |             8 |     800.00 |     6400.00 |                       27400.00 |                         223200.00 |
|  15 | 2024-02-05 | Product C    |            12 |     800.00 |     9600.00 |                       76200.00 |                         223200.00 |
|  81 | 2024-02-20 | Product C    |             6 |     800.00 |     4800.00 |                       28300.00 |                         223200.00 |
|  33 | 2024-02-04 | Product C    |             6 |     800.00 |     4800.00 |                       52600.00 |                         223200.00 |
+-----+------------+--------------+---------------+------------+-------------+--------------------------------+-----------------------------------+
105 rows in set (0.01 sec)
```
`PARTITION BY`の中に`CASE`等を記載して複雑な条件でパーティション分割することもできる。以下のクエリでは10日ごとの売り上げ合計を集計している。
```
mysql> select sale_date, product_name,
    ->     case
    ->         when dayofmonth(sale_date) between 1 and 10 then "1-10日"
    ->         when dayofmonth(sale_date) between 11 and 20 then "11-20日"
    ->         when dayofmonth(sale_date) between 21 and 30 then "21-30日"
    ->         else "31日"
    ->     end as day_range,
    ->     sum(total_price) over(
    ->         partition by
    ->             case
    ->                 when dayofmonth(sale_date) between 1 and 10 then "1-10日"
    ->                 when dayofmonth(sale_date) between 11 and 20 then "11-20日"
    ->                 when dayofmonth(sale_date) between 21 and 30 then "21-30日"
    ->                 else "31日"
    ->             end
    ->     ) as "10日ごとの売り上げ"
    -> from sales;
+------------+--------------+-----------+----------------------------+
| sale_date  | product_name | day_range | 10日ごとの売り上げ         |
+------------+--------------+-----------+----------------------------+
| 2024-02-07 | Product A    | 1-10日    |                  505900.00 |
| 2024-02-03 | Product A    | 1-10日    |                  505900.00 |
| 2024-02-03 | Product B    | 1-10日    |                  505900.00 |
| 2024-02-03 | Product C    | 1-10日    |                  505900.00 |
| 2024-02-04 | Product A    | 1-10日    |                  505900.00 |
| 2024-02-04 | Product B    | 1-10日    |                  505900.00 |
| 2024-02-04 | Product C    | 1-10日    |                  505900.00 |
| 2024-02-05 | Product A    | 1-10日    |                  505900.00 |
| 2024-02-05 | Product B    | 1-10日    |                  505900.00 |
| 2024-02-05 | Product C    | 1-10日    |                  505900.00 |
| 2024-02-06 | Product A    | 1-10日    |                  505900.00 |
| 2024-02-06 | Product B    | 1-10日    |                  505900.00 |
| 2024-02-06 | Product C    | 1-10日    |                  505900.00 |
| 2024-02-01 | Product B    | 1-10日    |                  505900.00 |
| 2024-02-07 | Product B    | 1-10日    |                  505900.00 |
| 2024-02-07 | Product C    | 1-10日    |                  505900.00 |
| 2024-02-08 | Product A    | 1-10日    |                  505900.00 |
| 2024-02-08 | Product B    | 1-10日    |                  505900.00 |
| 2024-02-08 | Product C    | 1-10日    |                  505900.00 |
| 2024-02-09 | Product A    | 1-10日    |                  505900.00 |
| 2024-02-09 | Product B    | 1-10日    |                  505900.00 |
| 2024-02-09 | Product C    | 1-10日    |                  505900.00 |
| 2024-02-10 | Product A    | 1-10日    |                  505900.00 |
| 2024-02-10 | Product B    | 1-10日    |                  505900.00 |
| 2024-02-10 | Product C    | 1-10日    |                  505900.00 |
| 2024-02-01 | Product A    | 1-10日    |                  505900.00 |
| 2024-02-02 | Product B    | 1-10日    |                  505900.00 |
| 2024-02-01 | Product C    | 1-10日    |                  505900.00 |
| 2024-02-02 | Product A    | 1-10日    |                  505900.00 |
| 2024-02-02 | Product B    | 1-10日    |                  505900.00 |
| 2024-02-02 | Product C    | 1-10日    |                  505900.00 |
| 2024-02-03 | Product A    | 1-10日    |                  505900.00 |
| 2024-02-03 | Product B    | 1-10日    |                  505900.00 |
| 2024-02-03 | Product C    | 1-10日    |                  505900.00 |
| 2024-02-04 | Product A    | 1-10日    |                  505900.00 |
| 2024-02-04 | Product B    | 1-10日    |                  505900.00 |
| 2024-02-04 | Product C    | 1-10日    |                  505900.00 |
| 2024-02-05 | Product A    | 1-10日    |                  505900.00 |
| 2024-02-05 | Product B    | 1-10日    |                  505900.00 |
| 2024-02-06 | Product A    | 1-10日    |                  505900.00 |
| 2024-02-05 | Product C    | 1-10日    |                  505900.00 |
| 2024-02-02 | Product C    | 1-10日    |                  505900.00 |
| 2024-02-02 | Product A    | 1-10日    |                  505900.00 |
| 2024-02-01 | Product C    | 1-10日    |                  505900.00 |
| 2024-02-01 | Product B    | 1-10日    |                  505900.00 |
| 2024-02-01 | Product A    | 1-10日    |                  505900.00 |
| 2024-02-07 | Product C    | 1-10日    |                  505900.00 |
| 2024-02-07 | Product B    | 1-10日    |                  505900.00 |
| 2024-02-07 | Product A    | 1-10日    |                  505900.00 |
| 2024-02-06 | Product C    | 1-10日    |                  505900.00 |
| 2024-02-06 | Product B    | 1-10日    |                  505900.00 |
| 2024-02-16 | Product B    | 11-20日   |                  300000.00 |
| 2024-02-16 | Product C    | 11-20日   |                  300000.00 |
| 2024-02-17 | Product A    | 11-20日   |                  300000.00 |
| 2024-02-17 | Product B    | 11-20日   |                  300000.00 |
| 2024-02-17 | Product C    | 11-20日   |                  300000.00 |
| 2024-02-18 | Product A    | 11-20日   |                  300000.00 |
| 2024-02-18 | Product B    | 11-20日   |                  300000.00 |
| 2024-02-18 | Product C    | 11-20日   |                  300000.00 |
| 2024-02-19 | Product A    | 11-20日   |                  300000.00 |
| 2024-02-19 | Product B    | 11-20日   |                  300000.00 |
| 2024-02-19 | Product C    | 11-20日   |                  300000.00 |
| 2024-02-20 | Product A    | 11-20日   |                  300000.00 |
| 2024-02-20 | Product B    | 11-20日   |                  300000.00 |
| 2024-02-11 | Product B    | 11-20日   |                  300000.00 |
| 2024-02-20 | Product C    | 11-20日   |                  300000.00 |
| 2024-02-15 | Product C    | 11-20日   |                  300000.00 |
| 2024-02-16 | Product A    | 11-20日   |                  300000.00 |
| 2024-02-11 | Product A    | 11-20日   |                  300000.00 |
| 2024-02-11 | Product C    | 11-20日   |                  300000.00 |
| 2024-02-12 | Product A    | 11-20日   |                  300000.00 |
| 2024-02-12 | Product B    | 11-20日   |                  300000.00 |
| 2024-02-12 | Product C    | 11-20日   |                  300000.00 |
| 2024-02-13 | Product A    | 11-20日   |                  300000.00 |
| 2024-02-13 | Product C    | 11-20日   |                  300000.00 |
| 2024-02-14 | Product A    | 11-20日   |                  300000.00 |
| 2024-02-14 | Product B    | 11-20日   |                  300000.00 |
| 2024-02-14 | Product C    | 11-20日   |                  300000.00 |
| 2024-02-15 | Product A    | 11-20日   |                  300000.00 |
| 2024-02-15 | Product B    | 11-20日   |                  300000.00 |
| 2024-02-13 | Product B    | 11-20日   |                  300000.00 |
| 2024-02-25 | Product A    | 21-30日   |                  242300.00 |
| 2024-02-25 | Product B    | 21-30日   |                  242300.00 |
| 2024-02-25 | Product C    | 21-30日   |                  242300.00 |
| 2024-02-26 | Product A    | 21-30日   |                  242300.00 |
| 2024-02-26 | Product B    | 21-30日   |                  242300.00 |
| 2024-02-26 | Product C    | 21-30日   |                  242300.00 |
| 2024-02-27 | Product A    | 21-30日   |                  242300.00 |
| 2024-02-27 | Product B    | 21-30日   |                  242300.00 |
| 2024-02-27 | Product C    | 21-30日   |                  242300.00 |
| 2024-02-28 | Product A    | 21-30日   |                  242300.00 |
| 2024-02-28 | Product B    | 21-30日   |                  242300.00 |
| 2024-02-28 | Product C    | 21-30日   |                  242300.00 |
| 2024-02-24 | Product C    | 21-30日   |                  242300.00 |
| 2024-02-24 | Product B    | 21-30日   |                  242300.00 |
| 2024-02-24 | Product A    | 21-30日   |                  242300.00 |
| 2024-02-23 | Product C    | 21-30日   |                  242300.00 |
| 2024-02-23 | Product B    | 21-30日   |                  242300.00 |
| 2024-02-23 | Product A    | 21-30日   |                  242300.00 |
| 2024-02-22 | Product C    | 21-30日   |                  242300.00 |
| 2024-02-22 | Product B    | 21-30日   |                  242300.00 |
| 2024-02-22 | Product A    | 21-30日   |                  242300.00 |
| 2024-02-21 | Product C    | 21-30日   |                  242300.00 |
| 2024-02-21 | Product B    | 21-30日   |                  242300.00 |
| 2024-02-21 | Product A    | 21-30日   |                  242300.00 |
+------------+--------------+-----------+----------------------------+
105 rows in set (0.00 sec)
```
上記のクエリは共通テーブル式を用いて見通しをよくこともできる。
```
mysql> with range_date as (
    ->     select sale_date, total_price,
    ->     case
    ->         when dayofmonth(sale_date) between 1 and 10 then "1-10日"
    ->         when dayofmonth(sale_date) between 11 and 20 then "11-20日"
    ->         when dayofmonth(sale_date) between 21 and 30 then "21-30日"
    ->         else "31日"
    ->     end as day_range
    ->     from sales
    -> )
    -> select sale_date, total_price, day_range,
    ->     sum(total_price) over (partition by day_range) as "10日ごとの売り上げ"
    -> from range_date;
+------------+-------------+-----------+----------------------------+
| sale_date  | total_price | day_range | 10日ごとの売り上げ         |
+------------+-------------+-----------+----------------------------+
| 2024-02-07 |    13000.00 | 1-10日    |                  505900.00 |
| 2024-02-03 |     9000.00 | 1-10日    |                  505900.00 |
| 2024-02-03 |    12000.00 | 1-10日    |                  505900.00 |
| 2024-02-03 |     8000.00 | 1-10日    |                  505900.00 |
| 2024-02-04 |    11000.00 | 1-10日    |                  505900.00 |
| 2024-02-04 |    10500.00 | 1-10日    |                  505900.00 |
| 2024-02-04 |     4800.00 | 1-10日    |                  505900.00 |
| 2024-02-05 |    15000.00 | 1-10日    |                  505900.00 |
| 2024-02-05 |    13500.00 | 1-10日    |                  505900.00 |
| 2024-02-05 |     9600.00 | 1-10日    |                  505900.00 |
| 2024-02-06 |     8000.00 | 1-10日    |                  505900.00 |
| 2024-02-06 |    15000.00 | 1-10日    |                  505900.00 |
| 2024-02-06 |     4000.00 | 1-10日    |                  505900.00 |
| 2024-02-01 |     7500.00 | 1-10日    |                  505900.00 |
| 2024-02-07 |    18000.00 | 1-10日    |                  505900.00 |
| 2024-02-07 |     6400.00 | 1-10日    |                  505900.00 |
| 2024-02-08 |    14000.00 | 1-10日    |                  505900.00 |
| 2024-02-08 |     9000.00 | 1-10日    |                  505900.00 |
| 2024-02-08 |     7200.00 | 1-10日    |                  505900.00 |
| 2024-02-09 |     7000.00 | 1-10日    |                  505900.00 |
| 2024-02-09 |    12000.00 | 1-10日    |                  505900.00 |
| 2024-02-09 |     8000.00 | 1-10日    |                  505900.00 |
| 2024-02-10 |    10000.00 | 1-10日    |                  505900.00 |
| 2024-02-10 |    16500.00 | 1-10日    |                  505900.00 |
| 2024-02-10 |     5600.00 | 1-10日    |                  505900.00 |
| 2024-02-01 |    10000.00 | 1-10日    |                  505900.00 |
| 2024-02-02 |     9000.00 | 1-10日    |                  505900.00 |
| 2024-02-01 |     6400.00 | 1-10日    |                  505900.00 |
| 2024-02-02 |    12000.00 | 1-10日    |                  505900.00 |
| 2024-02-02 |     9000.00 | 1-10日    |                  505900.00 |
| 2024-02-02 |     5600.00 | 1-10日    |                  505900.00 |
| 2024-02-03 |     9000.00 | 1-10日    |                  505900.00 |
| 2024-02-03 |    12000.00 | 1-10日    |                  505900.00 |
| 2024-02-03 |     8000.00 | 1-10日    |                  505900.00 |
| 2024-02-04 |    11000.00 | 1-10日    |                  505900.00 |
| 2024-02-04 |    10500.00 | 1-10日    |                  505900.00 |
| 2024-02-04 |     4800.00 | 1-10日    |                  505900.00 |
| 2024-02-05 |    15000.00 | 1-10日    |                  505900.00 |
| 2024-02-05 |    13500.00 | 1-10日    |                  505900.00 |
| 2024-02-06 |     8000.00 | 1-10日    |                  505900.00 |
| 2024-02-05 |     9600.00 | 1-10日    |                  505900.00 |
| 2024-02-02 |     5600.00 | 1-10日    |                  505900.00 |
| 2024-02-02 |    12000.00 | 1-10日    |                  505900.00 |
| 2024-02-01 |     6400.00 | 1-10日    |                  505900.00 |
| 2024-02-01 |     7500.00 | 1-10日    |                  505900.00 |
| 2024-02-01 |    10000.00 | 1-10日    |                  505900.00 |
| 2024-02-07 |     6400.00 | 1-10日    |                  505900.00 |
| 2024-02-07 |    18000.00 | 1-10日    |                  505900.00 |
| 2024-02-07 |    13000.00 | 1-10日    |                  505900.00 |
| 2024-02-06 |     4000.00 | 1-10日    |                  505900.00 |
| 2024-02-06 |    15000.00 | 1-10日    |                  505900.00 |
| 2024-02-16 |    12000.00 | 11-20日   |                  300000.00 |
| 2024-02-16 |     4800.00 | 11-20日   |                  300000.00 |
| 2024-02-17 |    13000.00 | 11-20日   |                  300000.00 |
| 2024-02-17 |    10500.00 | 11-20日   |                  300000.00 |
| 2024-02-17 |     8000.00 | 11-20日   |                  300000.00 |
| 2024-02-18 |     9000.00 | 11-20日   |                  300000.00 |
| 2024-02-18 |    16500.00 | 11-20日   |                  300000.00 |
| 2024-02-18 |     5600.00 | 11-20日   |                  300000.00 |
| 2024-02-19 |    12000.00 | 11-20日   |                  300000.00 |
| 2024-02-19 |     9000.00 | 11-20日   |                  300000.00 |
| 2024-02-19 |     6400.00 | 11-20日   |                  300000.00 |
| 2024-02-20 |    10000.00 | 11-20日   |                  300000.00 |
| 2024-02-20 |    13500.00 | 11-20日   |                  300000.00 |
| 2024-02-11 |    13500.00 | 11-20日   |                  300000.00 |
| 2024-02-20 |     4800.00 | 11-20日   |                  300000.00 |
| 2024-02-15 |     7200.00 | 11-20日   |                  300000.00 |
| 2024-02-16 |    10000.00 | 11-20日   |                  300000.00 |
| 2024-02-11 |    12000.00 | 11-20日   |                  300000.00 |
| 2024-02-11 |     4800.00 | 11-20日   |                  300000.00 |
| 2024-02-12 |     9000.00 | 11-20日   |                  300000.00 |
| 2024-02-12 |    19500.00 | 11-20日   |                  300000.00 |
| 2024-02-12 |     6400.00 | 11-20日   |                  300000.00 |
| 2024-02-13 |     8000.00 | 11-20日   |                  300000.00 |
| 2024-02-13 |     8000.00 | 11-20日   |                  300000.00 |
| 2024-02-14 |    14000.00 | 11-20日   |                  300000.00 |
| 2024-02-14 |     9000.00 | 11-20日   |                  300000.00 |
| 2024-02-14 |     4000.00 | 11-20日   |                  300000.00 |
| 2024-02-15 |    11000.00 | 11-20日   |                  300000.00 |
| 2024-02-15 |    18000.00 | 11-20日   |                  300000.00 |
| 2024-02-13 |    10500.00 | 11-20日   |                  300000.00 |
| 2024-02-25 |    12000.00 | 21-30日   |                  242300.00 |
| 2024-02-25 |     9000.00 | 21-30日   |                  242300.00 |
| 2024-02-25 |     5600.00 | 21-30日   |                  242300.00 |
| 2024-02-26 |     9000.00 | 21-30日   |                  242300.00 |
| 2024-02-26 |    12000.00 | 21-30日   |                  242300.00 |
| 2024-02-26 |     4800.00 | 21-30日   |                  242300.00 |
| 2024-02-27 |    10000.00 | 21-30日   |                  242300.00 |
| 2024-02-27 |    18000.00 | 21-30日   |                  242300.00 |
| 2024-02-27 |     6400.00 | 21-30日   |                  242300.00 |
| 2024-02-28 |    11000.00 | 21-30日   |                  242300.00 |
| 2024-02-28 |    10500.00 | 21-30日   |                  242300.00 |
| 2024-02-28 |     7200.00 | 21-30日   |                  242300.00 |
| 2024-02-24 |     8000.00 | 21-30日   |                  242300.00 |
| 2024-02-24 |    13500.00 | 21-30日   |                  242300.00 |
| 2024-02-24 |    13000.00 | 21-30日   |                  242300.00 |
| 2024-02-23 |     4000.00 | 21-30日   |                  242300.00 |
| 2024-02-23 |    10500.00 | 21-30日   |                  242300.00 |
| 2024-02-23 |     8000.00 | 21-30日   |                  242300.00 |
| 2024-02-22 |     9600.00 | 21-30日   |                  242300.00 |
| 2024-02-22 |    15000.00 | 21-30日   |                  242300.00 |
| 2024-02-22 |    15000.00 | 21-30日   |                  242300.00 |
| 2024-02-21 |     7200.00 | 21-30日   |                  242300.00 |
| 2024-02-21 |    12000.00 | 21-30日   |                  242300.00 |
| 2024-02-21 |    11000.00 | 21-30日   |                  242300.00 |
+------------+-------------+-----------+----------------------------+
105 rows in set (0.00 sec)
```
